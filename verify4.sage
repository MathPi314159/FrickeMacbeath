print('This program proves an upper bound for the number of eigenvalues of the Laplacian on the Fricke-Macbeath surface in the interval [0.77, 1.28].\n')

from sage.symbolic.integration.integral import indefinite_integral

a = QQ(0.77)
b = QQ(1.28)
# The endpoints of the interval, stored as rational numbers 
print('a=',a,', b=',b,'\n')

Z = [ QQ(r) for r in [] ]
# The list of double zeros for u, converted to rational numbers
W = [ QQ(r) for r in [1.9076, 4.9018, 9.45, 13.68, 19.76, 28.39, 38.80, 52.48, 85.97, 439.69, 791.36, 793.36, 865.76] ]
# The list of double zeros for v, converted to rational numbers

print('The list of prescribed double zeros for u is',Z,'\n')
print('The list of prescribed double zeros for v is',W,'\n')

S = (-173627784353146955754244708103565251667202929868177270958489982634105467517622442269906922636773675193524752996478635387525160532299046564617448814681740393288658450382621000159677943453882066352559329699575077895667729138328821561974734818959814661578363018855282460728627509169702903739834805260323663087613045274686824734694371974421884692342563240673319437225183369798042391238757561822723968617204275700880041444477567997940381992803562266462641712134813445081913415023672656517649223374018426600311579/7383086801395508019780282574659425466324748535377430294372268263174112352788515004421822169965441213090161394439597041213875337490869225444804514227339972848805679713251499651398800692731041364385938206464429342643252588636834511522404073455330786894174629367752467565134361391283555541340190387634278793295654922363701865081693905081334992010532295968434666327462868379683436421056432398710214326307990139493650067735079049402892526685395159924512134136485085422856329265513888950074970134275888243343604264468480, 353845893233738333486171053899827068939241319380598286207624280967527378258166244081430227323758223738594923271715486329188732781175137794198618744247949403869078895861516225395704408420888258938687134416134639157530143784735963129987611654360802734941931740242481412073151242292982364903214694685942065989515373645593882412134248107708511827541308325539026966310269398125191524930138899884768372779264518373058186393919976006042938095068628133802887730922258571643361507413321201273033537740659605050700933/3691543400697754009890141287329712733162374267688715147186134131587056176394257502210911084982720606545080697219798520606937668745434612722402257113669986424402839856625749825699400346365520682192969103232214671321626294318417255761202036727665393447087314683876233782567180695641777770670095193817139396647827461181850932540846952540667496005266147984217333163731434189841718210528216199355107163153995069746825033867539524701446263342697579962256067068242542711428164632756944475037485067137944121671802132234240, -69353997161196518699140989180805926463847775882808603471541461945475660737472725681008304949473204934093948105789852135708957366499771957814671773721935041332269406357851492561294442764400497071837406189886283560666560495258201535735681334967264950875024329505445348892952680857489466873806318241866532206098732546358426184279738743860568730319447410548328691311141378373967557982636463613073502068744637583309091213139899724961008090063993084218373968330886101771734941613059387849270473835370294527159515/553731510104663101483521193099456909974356140153307272077920119738058426459138625331636662747408090981762104582969778091040650311815191908360338567050497963660425978493862473854910051954828102328945365484832200698243944147762588364180305509149809017063097202581435067385077104346266665600514279072570909497174119177277639881127042881100124400789922197632599974559715128476257731579232429903266074473099260462023755080130928705216939501404636994338410060236381406714224694913541671255622760070691618250770319835136, 12481919064603405479715623394471235443707593002185492446855607554029576339307240223713237075548227390960264580752370824011186453351104736347116055896302624941125595887870240158037581846392383683046692168515084554010054923963247876631071411934765563123656803048457392047504083200618942014183939764405066181549116401255246305484375685871075691951450429002971335286652487941923364665086236068490041257827203794720503463614072683785577693485569181745993291751036205748631823674610362451696470955827049529996765/92288585017443850247253532183242818329059356692217878679653353289676404409856437555272777124568015163627017430494963015173441718635865318060056427841749660610070996415643745642485008659138017054824227580805366783040657357960431394030050918191634836177182867096905844564179517391044444266752379845428484916195686529546273313521173813516687400131653699605433329093285854746042955263205404983877679078849876743670625846688488117536156583567439499056401676706063567785704115818923611875937126678448603041795053305856, -1533467949136754399815197142213580948475834678791324501149148863910789958106815078621165800311027391338831292369027860044510604145829754020729588257732932537995699582969533247533856650480390346397262523698418522407102350030541758173913583896136002676292224919034448380938640068208114873315893681261813278785688639344570616323459856885915985046347240235435211974097541117527923080238345004585893429188846993792668024528129189647771934640266019844789971543803618373530115177839560426784997305192103912007625/11536073127180481280906691522905352291132419586527234834956669161209550551232054694409097140571001895453377178811870376896680214829483164757507053480218707576258874551955468205310626082392252131853028447600670847880082169745053924253756364773954354522147858387113230570522439673880555533344047480678560614524460816193284164190146726689585925016456712450679166136660731843255369407900675622984709884856234592958828230836061014692019572945929937382050209588257945973213014477365451484492140834806075380224381663232, 44681134827917058665520322101517137693906059334939648901097156230509731573865956820462520942518831698377059769757068203715085708514078463707796627794348238746462870849342174245063627502327375843184335439149669893459632882155690634224611344290477149335948379701457515146684889301588336627777832139581531165338959373185199399304335635442475066714094890941636795373715145526906993352082328736040043429089952269533272943385034991671789043233480309071916207162329554877518653773076945538113491353791511158235625/363386303506185160348560782971518597170671216975607897301135078578100842363809722873886559927986559706781381132573916872245426767128719689861472184626889288652154548386597248467284721595355942153370396099421131708222588346969198613993325490379562167447657539194066762971456849727237499300337495641374659357520515710088451171989621890721956638018386442196393733304813053062544136348871282124018361372971389678203089271335921962798616547796793027534581602030125298156209956037011721761502436296391374477068022391808, -3286284798419503162817023026887543542441582046238652500447774596854959877993871531700932719407998095343002958497502683478671049339062441924692109663283926495773530555447338709165786628220349931250049905183058805945577783376826595365002174450783978746074351520389599528839874173132470285177863853442395995973231439700190336057440064488972680176126930947033957490668737184740286842631100077769376666991342296693559900607646083129142562202016979409134147031997562887800631394934577108183575868605432201828125/30282191958848763362380065247626549764222601414633991441761256548175070196984143572823879993998879975565115094381159739353785563927393307488456015385574107387679545698883104038940393466279661846114199674951760975685215695580766551166110457531630180620638128266172230247621404143936458275028124636781221613126709642507370930999135157560163053168198870183032811108734421088545344695739273510334863447747615806516924105944660163566551378983066085627881800169177108179684163003084310146791869691365947873089001865984, 66334579759726810165556182082862844531037315653900436747676007611337314340698597934421043046426320616923149832769714379586371291539644867590370639773397802933101739065957873264394411108945787615773917219494303993182157362187124328088278555734542153654884297905052076326863528404347546982103713554171119194088994313408593351913522296542647648238833781096217650334230622577952449913565566738892287501585827148434031890260014800159001842492875765308418547256670675819031208712691799096669568545462362890625/721004570448780080056668220181584518195776224157952177184791822575596909452003418400568571285687618465836073675741898556042513426842697797344190842513669223516179659497216762831914130149515758240814277975041927992505135609065870265859772798372147157634241149194576910657652479617534720834002967542410038407778801012080260261884170418099120313528544528167447883541295740203460587993792226436544367803514662059926764427253813418251223309120621086378138099266121623325813404835340717780758802175379711264023853952, -10128900111105141357413529162462958722793584810315255326208714441734208147119962072617786878545409845162808202154383937188228691302015942639932164536712067838498200966032557804800289647430023210452254918997546596699264129971218910796158622721646885634783826029249292829872097578725025638465297417381800868133887449481803433064363664958624563984019383184032491931885145972172129237452993174703987429349623460992341225101903740494226438629404906379067987607415201633789199583422163731615161274879814453125/135188356959146265010625291284047097161708042029616033222148466732924420522250640950106607116066428462344263814201605979257971267533005837002035782971312979409283686155728143030983899403034204670152677120320361498594712926699850674848707399694777592056420215473983170748309839928287760156375556414201882201458525189765048799103281953393585058786602099031396478163992951288148860248836042456852068963158999136236268330110090015922104370460116453695900893612397804373590013406626384583892275407883695862004472616, 1317971916522176445129489653708041214731989363052143320036842259418324003947368929111596757413861427511452865433272352768043467414557135617428026930295529243602582679537552103407354493507569653829811584826129032896757893147947022595593564308974152505251718492955510639518525414893574663889721946661028520184991114309628143010605914335259563538194776774841259101012156375327878436803846284975805146395464571418522851003060398742586980648871228833102698437600708313196312322603231243572848170452392578125/22531392826524377501770881880674516193618007004936005537024744455487403420375106825017767852677738077057377302366934329876328544588834306167005963828552163234880614359288023838497316567172367445025446186720060249765785487783308445808117899949129598676070035912330528458051639988047960026062592735700313700243087531627508133183880325565597509797767016505232746360665491881358143374806007076142011493859833189372711388351681669320350728410019408949316815602066300728931668901104397430648712567980615977000745436, -245517382569066473109401879553434446144467482185145112036741357327939561465080516620177682674928597575527757050609532147985360390645451476837358377091152198015879466744619127569918328339340821659561419805120900007157184636523797633891437216888373594252450335829609369629709073906241353907710684726676241036966811899638584146582389127029964610946248952136572609452087795564632863312466347720600893298208312165727937058822572782432228904350487898305083449210839600014411949055218440160076059356689453125/5632848206631094375442720470168629048404501751234001384256186113871850855093776706254441963169434519264344325591733582469082136147208576541751490957138040808720153589822005959624329141793091861256361546680015062441446371945827111452029474987282399669017508978082632114512909997011990006515648183925078425060771882906877033295970081391399377449441754126308186590166372970339535843701501769035502873464958297343177847087920417330087682102504852237329203900516575182232917225276099357662178141995153994250186359, 173701351626207984624172394993190213100505746344702662247502776953084002820322713618233757117663353755763462812442321564202498487020871665758625597216897728346117309711308800092506203728746045837122866636764564757635124894439026194245562497271066908464201681892622027079586264356382132907020848037859932996698747334463176350399318269392395966285569417997656210359806173985385613983007381663503589639575898128073748707117401221331055650589090475692517362813184156988131159781470794763127388000488281250/5632848206631094375442720470168629048404501751234001384256186113871850855093776706254441963169434519264344325591733582469082136147208576541751490957138040808720153589822005959624329141793091861256361546680015062441446371945827111452029474987282399669017508978082632114512909997011990006515648183925078425060771882906877033295970081391399377449441754126308186590166372970339535843701501769035502873464958297343177847087920417330087682102504852237329203900516575182232917225276099357662178141995153994250186359, -115894759165800169569670789311892367109528025542743622282599676134723960379625281022352206185549147014233423467390269170962557403671555244683344548924708050658642008974716068028128460575792155070158159428485471656528706888333058924440600434664219760251923197448380186104022700264375113747512395732396541034933331536893578533083069579364999479223794339275238244821747303800938191702884835767553663191721656424450753781607240687607435417179284889956285060335069445932409901426435762264095153808593750000/5632848206631094375442720470168629048404501751234001384256186113871850855093776706254441963169434519264344325591733582469082136147208576541751490957138040808720153589822005959624329141793091861256361546680015062441446371945827111452029474987282399669017508978082632114512909997011990006515648183925078425060771882906877033295970081391399377449441754126308186590166372970339535843701501769035502873464958297343177847087920417330087682102504852237329203900516575182232917225276099357662178141995153994250186359, 72340288199012902921685916554412568804828393411634470099674303476994533732157714652080434204262283360675049527281226904642023815568619018933058438697549469536642383000562271628973475065475876430805140914283740837521980261224339625266409897736991768952492537975598480406865065576239443847305025266336493495434763121164935698844618436611232745259599763035897917675042650747857117932928484326764160527050508204821335251664398774637369196801073794480345095689951457084293440486970706433425903320312500000/5632848206631094375442720470168629048404501751234001384256186113871850855093776706254441963169434519264344325591733582469082136147208576541751490957138040808720153589822005959624329141793091861256361546680015062441446371945827111452029474987282399669017508978082632114512909997011990006515648183925078425060771882906877033295970081391399377449441754126308186590166372970339535843701501769035502873464958297343177847087920417330087682102504852237329203900516575182232917225276099357662178141995153994250186359, -41729134504920138122338153702163591008914018231398753526219109293004724811923830431637979185055521698619525229879652672523874352749839937654892143992865449760109351748408904115562546507948322973994915267704398132998291799084569813837053224475970152079434660879405300172919813997341944359574406066089105103625914706865656115787734792480156639380713393796960771079600350679057162038792377907312352499236249465841686281624655115000618246890215351661648439752229100657565034574972254429626464843750000000/5632848206631094375442720470168629048404501751234001384256186113871850855093776706254441963169434519264344325591733582469082136147208576541751490957138040808720153589822005959624329141793091861256361546680015062441446371945827111452029474987282399669017508978082632114512909997011990006515648183925078425060771882906877033295970081391399377449441754126308186590166372970339535843701501769035502873464958297343177847087920417330087682102504852237329203900516575182232917225276099357662178141995153994250186359, 21842356210603193502716330940156014683207039544813583173213533510800046658069961060541940390213132998124971163589538100974433678358495677569703060270125948599832860083269507609174691086202494321251389229137903895038402384222209551913418334462171910978375906558648863581844510832578061799009072629383144201189213763996421983976389665787771838049690740760794557923166408822508345278133618901497709192379767359822778627050501706101060565120985617756036059629878718246930894491396754074096679687500000000/5632848206631094375442720470168629048404501751234001384256186113871850855093776706254441963169434519264344325591733582469082136147208576541751490957138040808720153589822005959624329141793091861256361546680015062441446371945827111452029474987282399669017508978082632114512909997011990006515648183925078425060771882906877033295970081391399377449441754126308186590166372970339535843701501769035502873464958297343177847087920417330087682102504852237329203900516575182232917225276099357662178141995153994250186359, -10056197674556259484254776925919579542178492383874923370361250377488955181949422374877654749796410615838068607306082883183095654481358726498550033350918549906096904239194507046634606212661635613400971588833256989884012602667326644895394629791736403092179719733262605055128953130628412237223697777606469978189826446481976125152669061906120860360318190723382916537643239696693802143737597520000065305321180959024378114484840945514809092850107459064909172000266051499475929197253417968750000000000000000/5632848206631094375442720470168629048404501751234001384256186113871850855093776706254441963169434519264344325591733582469082136147208576541751490957138040808720153589822005959624329141793091861256361546680015062441446371945827111452029474987282399669017508978082632114512909997011990006515648183925078425060771882906877033295970081391399377449441754126308186590166372970339535843701501769035502873464958297343177847087920417330087682102504852237329203900516575182232917225276099357662178141995153994250186359, 3882726634641974232404258500155008232218946024022269169309485628287225121644319104249788251342368308847111485130425610175394844479408859896526383530079972076794820361099847473886579251451535267279815420090608719512035507053815806552179480835349611756119744198974995367410423563263706788304677741998435196074819288424369538895500340699721819782057286081962678733408130157824438984838556744062701815313132140181428149646808952159905440270508461394456262160537740686041041333190917968750000000000000000/5632848206631094375442720470168629048404501751234001384256186113871850855093776706254441963169434519264344325591733582469082136147208576541751490957138040808720153589822005959624329141793091861256361546680015062441446371945827111452029474987282399669017508978082632114512909997011990006515648183925078425060771882906877033295970081391399377449441754126308186590166372970339535843701501769035502873464958297343177847087920417330087682102504852237329203900516575182232917225276099357662178141995153994250186359, -1155438765367928197385036612078129255350140959726906531893672842090660692058929491599458475254973243489735864658924740181131239617672569843111727487799319966610926806214733986908136578201416960446583854851185271754048452169595005647729300802884772661213351951451790980498983078144844165449970396528580558753424671266252501633446034425472303186510079058795788023808643140578455937828159878178586587370422341547790316161860498560384486784062497400537594372465713087215335449218750000000000000000000000/5632848206631094375442720470168629048404501751234001384256186113871850855093776706254441963169434519264344325591733582469082136147208576541751490957138040808720153589822005959624329141793091861256361546680015062441446371945827111452029474987282399669017508978082632114512909997011990006515648183925078425060771882906877033295970081391399377449441754126308186590166372970339535843701501769035502873464958297343177847087920417330087682102504852237329203900516575182232917225276099357662178141995153994250186359, 238390521852816452334487942439036366150765194799529561921627743041440031780667217831741054826677542615714712241875501254438727006905834036833095857100236720789489965733712320719363131709349161111547001740509147771474555409436646625556099428105713463959629482811759578046215151996870340756908785767721662010758904912382655735519473230294986513065542684732882827973677676695243172830439815552333135907250207718168098167300923478337389963260900646701170683061188333801843261718750000000000000000000000/5632848206631094375442720470168629048404501751234001384256186113871850855093776706254441963169434519264344325591733582469082136147208576541751490957138040808720153589822005959624329141793091861256361546680015062441446371945827111452029474987282399669017508978082632114512909997011990006515648183925078425060771882906877033295970081391399377449441754126308186590166372970339535843701501769035502873464958297343177847087920417330087682102504852237329203900516575182232917225276099357662178141995153994250186359, -31093476749214788442093734836530436766928429080105968515385712155602419137818790585461113646888710841681250960708909862602325398536499376135261078823264014905872393248741390904072214318922819026228025632998987731215496115575721411905415444885100738940663944384004472596805478272744412561338737367312753253609199228052166410005659626870528856174866257141669978961483707895251332554445692146807043825002804633283982801276242863160609288194485957294233474665096047675781250000000000000000000000000000/5632848206631094375442720470168629048404501751234001384256186113871850855093776706254441963169434519264344325591733582469082136147208576541751490957138040808720153589822005959624329141793091861256361546680015062441446371945827111452029474987282399669017508978082632114512909997011990006515648183925078425060771882906877033295970081391399377449441754126308186590166372970339535843701501769035502873464958297343177847087920417330087682102504852237329203900516575182232917225276099357662178141995153994250186359, 2634183023571044310350521579572043835699859580975119939567514058172431365457144263944410840067801117706604194144947403141870746895408062635494834627186178453509435253299923211879386964020892234212420886935332408094531852315840996042245123114836999978165584899884958384529303637208550169815723794602641303823522306880247167194460277882231082512569888951809074003872404053004515484462431848467444366750020810433704504080294833856925524062742334874790098425348370605468750000000000000000000000000000/5632848206631094375442720470168629048404501751234001384256186113871850855093776706254441963169434519264344325591733582469082136147208576541751490957138040808720153589822005959624329141793091861256361546680015062441446371945827111452029474987282399669017508978082632114512909997011990006515648183925078425060771882906877033295970081391399377449441754126308186590166372970339535843701501769035502873464958297343177847087920417330087682102504852237329203900516575182232917225276099357662178141995153994250186359, -150617243467442024039290205420470824568678713812859612989609159090240060672764824117060282426051347022458005466929083371316153772344771970146364071121801450552679829752278627879079386867037756674688498657775810909417434444503476531305393160418972448504937131888615359531144032834712869715718216609133104625794627435923124398487946327367245822907095614321357739967927345269721142697853496020044072802166396001296997374033925437444005875056319081928689524324707031250000000000000000000000000000000/5632848206631094375442720470168629048404501751234001384256186113871850855093776706254441963169434519264344325591733582469082136147208576541751490957138040808720153589822005959624329141793091861256361546680015062441446371945827111452029474987282399669017508978082632114512909997011990006515648183925078425060771882906877033295970081391399377449441754126308186590166372970339535843701501769035502873464958297343177847087920417330087682102504852237329203900516575182232917225276099357662178141995153994250186359, 5926966026025614679028207483646741620260708628776589539454855271848511036285443573831299759364765762642861805047385328118881222467339976037138336934363599020719376763380965870869980261902419526497867718914594702865037429447159441806262783022344518295967600226258880940799806900050430084854785678791403416125050854182602844551444530120926956625527686577611970689428888744632906437203951437627545574025025797117663606091869071334396520118815492365712654633789062500000000000000000000000000000000/5632848206631094375442720470168629048404501751234001384256186113871850855093776706254441963169434519264344325591733582469082136147208576541751490957138040808720153589822005959624329141793091861256361546680015062441446371945827111452029474987282399669017508978082632114512909997011990006515648183925078425060771882906877033295970081391399377449441754126308186590166372970339535843701501769035502873464958297343177847087920417330087682102504852237329203900516575182232917225276099357662178141995153994250186359, -159696231275423115244479397556317030960884287347152525601924091573767670760574563624767177983050332509805207690123649606173332118279095674944218083103987020452341571866364246818984984092260450435948304248289719644606809733473034403922619140188347877305281824478975472578489048273083066304780973487553572827660164071176737586951403773138653518046080593089606833381425679665660696474993068475046926155931697864186255709877129505383332469394233048217578125000000000000000000000000000000000000000/5632848206631094375442720470168629048404501751234001384256186113871850855093776706254441963169434519264344325591733582469082136147208576541751490957138040808720153589822005959624329141793091861256361546680015062441446371945827111452029474987282399669017508978082632114512909997011990006515648183925078425060771882906877033295970081391399377449441754126308186590166372970339535843701501769035502873464958297343177847087920417330087682102504852237329203900516575182232917225276099357662178141995153994250186359, 2836889957391807038103118505251344613845881990606418085895374632689467327507585824218227563673273751707983364854832978721224459018743163341997368990760345142194140331171480309753788781832811463678409051375429551486393736295677056270314286054612625010731116362729479506996353065562732938412699873049106385516005386699023161464258222835657667639772888585681264993931559304864496733286763876036977497962498257695386691948103441794050443453693304443359375000000000000000000000000000000000000000/5632848206631094375442720470168629048404501751234001384256186113871850855093776706254441963169434519264344325591733582469082136147208576541751490957138040808720153589822005959624329141793091861256361546680015062441446371945827111452029474987282399669017508978082632114512909997011990006515648183925078425060771882906877033295970081391399377449441754126308186590166372970339535843701501769035502873464958297343177847087920417330087682102504852237329203900516575182232917225276099357662178141995153994250186359, -30142141808672233893378979701443451300368329916823263456178677706531227523864541161462310022798045086589487682041775247336598825230358730102956135228171153511605548438308170834623821583351186326386474229922108100343456125944913222244571759023324092169274089950858497818663634729224307787695507222185116679020398429362841942367045332865052470849142913338757985486683331789013422469728031606843439528909095938155995995089501250248329742065429687500000000000000000000000000000000000000000000/5632848206631094375442720470168629048404501751234001384256186113871850855093776706254441963169434519264344325591733582469082136147208576541751490957138040808720153589822005959624329141793091861256361546680015062441446371945827111452029474987282399669017508978082632114512909997011990006515648183925078425060771882906877033295970081391399377449441754126308186590166372970339535843701501769035502873464958297343177847087920417330087682102504852237329203900516575182232917225276099357662178141995153994250186359, 145961966264927105268231134512295904457609768357077575757942511222460140061307978173094929683083642679339436097068228824776903859131731456314985920821155197235468994099547180741307416496108875095627441380998264673893942317439081622466337743464999648478145729316721326093778910714604267755411248160459902371161434444841115097479403869688338908297119306926456180737813083872950448147294944844899262936320774576634890223592747397301330566406250000000000000000000000000000000000000000000000/5632848206631094375442720470168629048404501751234001384256186113871850855093776706254441963169434519264344325591733582469082136147208576541751490957138040808720153589822005959624329141793091861256361546680015062441446371945827111452029474987282399669017508978082632114512909997011990006515648183925078425060771882906877033295970081391399377449441754126308186590166372970339535843701501769035502873464958297343177847087920417330087682102504852237329203900516575182232917225276099357662178141995153994250186359)
# The vector of coefficients for u (generated with another program) 
print("The vector of coefficients is",S,"\n")

P.<x> = PolynomialRing(QQ) 
# P is the polynomial ring with rational coefficients
L = [ P(gen_laguerre(n,-1/2,x)) for n in range(len(S))]
# A list of the generalized Laguerre polynomials L_n^(-1/2) for n between 0 and len(S)-1

u = sum([S[j]*L[j] for j in range(len(S))])
v = sum([(-1)^j*S[j]*L[j] for j in range(len(S))])
# This is the unique polynomial such that v(x^2)*e^(-x^2/2) is the Fourier transform of u(x^2)*e^(-x^2/2)
print("u is equal to",u,"\n")
print("v is equal to",v,"\n")

u_der = u.derivative()
v_der = v.derivative()
# The first derivative of u and v

u_der_der = u_der.derivative()
v_der_der = v_der.derivative()
# The second derivative of u and v

#The following verifies that u and v vanish at the precribed orders at the zeros

flag = True
# A Boolean that we modify whenever a condition is not met

for j in range(len(Z)):
    if u(Z[j])!=0 :
        flag = False
        print('u does not vanish at one of the prescribed double zeros.\n')
                        
    if u_der(Z[j])!=0 :
        flag = False
        print('u_der does not vanish at one of the prescribed double zeros.\n')

    if u_der_der(Z[j])>=0 :
        flag = False
        print('either u vanishes to higher order at one of the prescribed zeros or it has a local minimum there, making it positive nearby.\n')

for j in range(len(W)):
    if v(W[j])!=0 :
        flag = False
        print('v does not vanish at one of the prescribed double zeros.\n')
                        
    if v_der(W[j])!=0 :
        flag = False
        print('v_der does not vanish at one of the prescribed double zeros.\n')

    if v_der_der(W[j])<=0 :
        flag = False
        print('either v vanishes to higher order at one of the prescribed zeros or it has a local maximum there, making it negative nearby.\n')

# We then check that u(x^2) has no other zeros in [5.7962,infinity) besides the double ones and is negative at 5.7962.

count = 0
for point in Z:
    if point >= (57962/10000)^2:
        count = count+1


if pari.polsturm(u,[(57962/10000)^2,Infinity])>count: 
    flag = False
    print('u has an extra zero.\n')
    
if u((57962/10000)^2)>=0: 
    flag = False
    print('u(x^2) is non-negative at 5.7962.\n')
    
print('The value of u at 5.7962^2 is',u((57962/10000)^2))


# We also check that that v has no extra zeros in [a-1/4,infinity) and satisfies v(a-1/4)>0.

count = 0
for point in W:
    if point >= a-1/4:
        count = count+1

if pari.polsturm(v,[a-1/4,Infinity])>count:
    flag = False
    print('v has an extra zero.\n')
    
if v(a-1/4)<=0: 
    flag = False
    print('v is non-positive at a-1/4.\n')
                               
# We then check that f^(x) = v(x^2)*e^(-x^2/2) is either monotone or has a unique local maximum on the interval [r(a),r(b)] where r(t)=sqrt(t-1/4)

crit = pari.polsturm(2*v_der-v,[a-1/4,b-1/4])

if crit>1:    
    flag = False
    print('f^ has more than one critical point in [r(a),r(b)].\n')

if crit==1:    
# This means that f^ has a critical point, so we check that it is a local maximum
    
    if 2*v_der(a-1/4)-v(a-1/4)<=0:    
        flag = False
        print('f^ does not have a positive derivative at r(a).\n')
            
    if 2*v_der(b-1/4)-v(b-1/4)>=0:    
        flag = False
        print('f^ does not have a negative derivative at r(b).\n')  

#If the number of critical points is zero, then f^ is monotone on the interval, hence attains its minimum at an endpoint.
        
# After all the checks, we verify the value of flag     
if flag==True:
    print('All the conditions on u and v are satisfied.\n')
    
# Finally, we estimate the upper bound that f yields from above using interval arithmetic
# Here RBF and CBF denote the RealBallField and ComplexBallField from the Arb package

# h is defined so that f^(x) = h(x^2)
def h(t):
    return v(t)*e^(-t/2)

# We first compute the minimum of f^ at r(a) and r(b), which gives a lower bound on the interval [r(a),r(b)].
# For this, we tell Sage to consider these inputs as real ball fields, so that subsequent calculations are done with interval arithmetic. 
lower_bound = min(h(RBF(a-1/4)),h(RBF(b-1/4)))
print('f^ is at least',lower_bound.lower(),'on [r(a),r(b)].\n')

# We then estimate the integral term in the Selberg trace formula
truncated_integral = 12*CBF.integral(lambda x, _: h(x^2)*x*tanh(CBF(pi)*x),0,200)

# For the remainder of the integral, we compute an indefinite integral and verify that it is a polynomial multiplied by e^(-x^2/2)
V(x) = indefinite_integral(h(x^2)*x,x)
D = e^(x^2/2)*V(x)
p = D.full_simplify()
if p.is_polynomial(x)!=True:
    print('Error, V is not of the form e^(-x^2/2)p(x) where p is a polynomial.\n')
remainder = -12*V(RBF(200))

# We compute the contribution of the shortest and second closed geodesics in the geometric term 
def f(x):
    return u(x^2)*e^(-x^2/2)
def w(x): 
    return (x/sinh(x/2))*f(x)
# This is the contribution of each geodesic of length x in the geometric sum (the factor of 2 is not there because we consider unoriented geodesics)

LenC=arccosh(cot(pi/3)*cot(pi/7))
LenB=arcsinh(sin(pi/3)*sinh(LenC))
LenA=arcsinh(sin(pi/7)*sinh(LenC))
l1 = 4*(LenA+LenB+LenC) 
# This is the systole of the Fricke-Macbeath surface 
l2 = 4*arccosh(sinh(LenA+LenB+LenC)*sinh(LenA+LenB+LenC))
# This is the length of the second shortest geodesics on the Fricke-Macbeath surface 
geom = RBF((1/sqrt(2*pi))*(126*w(l1)+252*w(l2)))
# There are 126 systoles of length l1 and 252 curves of length l2, so geom is the resulting sum

# We then compute the resulting upper bound on the number of eigenvalues in [a,b] (recall that h(-1/4) = f^(i/2))
multiplicity = (truncated_integral + remainder + geom - h(RBF(-1/4)))/lower_bound
print('The final upper bound is at most',RBF(multiplicity).upper())
# We convert the CBF element multiplicity to RBF to get an upper bound on it 
# (only CBF can compute integrals, but its balls do not have upper bounds)
